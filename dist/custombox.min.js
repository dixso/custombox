/*
 *  Custombox v2.0.0 - 2014-11-02
 *  Modal Window Effects with transitions CSS3.
 *  http://dixso.github.io/custombox/
 *  (c) 2014 Julio de la Calle - @dixso9
 *
 *  Under MIT License - http://www.opensource.org/licenses/mit-license.php
 */
var Custombox=function(){"use strict";var a={w:window,d:document,h:document.documentElement,b:document.body,qS:document.querySelector,create:document.createElement,settings:[],overlay:[],wrapper:[],container:[],modal:[],content:[],inline:[],size:[],close:[],open:[],scroll:[],item:-1},b={target:null,cache:!1,escKey:!0,zIndex:"auto",overlay:!0,overlayColor:"#000",overlayOpacity:.8,overlayClose:!0,overlaySpeed:300,overlayEffect:"auto",width:null,effect:"fadein",position:null,speed:500,open:null,complete:null,close:null},c={isIE:navigator.appVersion.indexOf("MSIE 8.")>-1||navigator.appVersion.indexOf("MSIE 9.")>-1,overlay:{perspective:["letmein","makeway","slip"],together:["corner","slidetogether","scale","door","push","contentscale","simplegenie","slit"]},modal:{position:["slide","flip","rotate"]}},d={init:function(){this.merge().built().check().binds()},merge:function(){return a.item++,a.settings.push(e.extend({},b,a.options)),delete a.options,"auto"===a.settings[a.item].overlayEffect&&(a.settings[a.item].overlayEffect=a.settings[a.item].effect),this},built:function(){var b=e.zIndex();if(a.h.classList.add("custombox-open","custombox-open-"+a.settings[a.item].overlayEffect),c.overlay.perspective.indexOf(a.settings[a.item].overlayEffect)>-1&&(a.scroll.push(a.h&&a.h.scrollTop||a.b&&a.b.scrollTop||0),a.h.classList.add("custombox-perspective"),a.w.scrollTo(0,0)),"undefined"==typeof a.main){for(a.main=a.create.call(a.d,"div"),a.main.classList.add("custombox-container","custombox-container-"+a.settings[a.item].overlayEffect);a.b.firstChild;)a.main.appendChild(a.b.firstChild);a.b.appendChild(a.main),"push"===a.settings[a.item].overlayEffect&&(a.main.style.transitionDuration=a.settings[a.item].speed+"ms")}else a.main.classList.add("custombox-container-"+a.settings[a.item].overlayEffect);return a.settings[a.item].overlay&&(a.overlay.push(a.create.call(a.d,"div")),a.overlay[a.item].classList.add("custombox-overlay","custombox-overlay-"+a.settings[a.item].overlayEffect),a.overlay[a.item].style.zIndex=b+1,a.overlay[a.item].style.backgroundColor=a.settings[a.item].overlayColor,c.overlay.perspective.indexOf(a.settings[a.item].overlayEffect)>-1||c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?a.overlay[a.item].style.opacity=a.settings[a.item].overlayOpacity:a.overlay[a.item].classList.add("custombox-overlay-default"),a.overlay[a.item].style.transitionDuration=c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?a.settings[a.item].speed+"ms":a.settings[a.item].overlaySpeed+"ms",a.b.insertBefore(a.overlay[a.item],a.b.lastChild.nextSibling)),a.wrapper.push(a.create.call(a.d,"div")),a.wrapper[a.item].classList.add("custombox-modal-wrapper","custombox-modal-wrapper-"+a.settings[a.item].effect),a.wrapper[a.item].style.zIndex=b+2,a.b.insertBefore(a.wrapper[a.item],a.b.firstChild),a.container.push(a.create.call(a.d,"div")),a.container[a.item].classList.add("custombox-modal-container","custombox-modal-container-"+a.settings[a.item].effect),a.container[a.item].style.zIndex=b+3,c.modal.position.indexOf(a.settings[a.item].effect)>-1&&(a.settings[a.item].position=null!==a.settings[a.item].position?a.settings[a.item].position.indexOf(",")>-1?a.settings[a.item].position.split(","):[a.settings[a.item].position]:"slide"===a.settings[a.item].effect?["top"]:"flip"===a.settings[a.item].effect?["horizontal"]:["bottom"]),a.modal.push(a.create.call(a.d,"div")),a.modal[a.item].classList.add("custombox-modal","custombox-modal-"+a.settings[a.item].effect+(c.modal.position.indexOf(a.settings[a.item].effect)>-1?"-"+a.settings[a.item].position[0].trim():"")),a.modal[a.item].style.transitionDuration=a.settings[a.item].speed+"ms",a.modal[a.item].style.zIndex=b+4,a.wrapper[a.item].appendChild(a.container[a.item]).appendChild(a.modal[a.item]),this},check:function(){return"function"==typeof a.settings[a.item].open&&a.settings[a.item].open.call(),"#"===a.settings[a.item].target.charAt(0)||"."===a.settings[a.item].target.charAt(0)?a.qS.call(a.d,a.settings[a.item].target)?(a.inline.push(a.create.call(a.d,"div")),a.content.push(a.qS.call(a.d,a.settings[a.item].target)),a.content[a.item].style.display="block",a.content[a.item].parentNode.insertBefore(a.inline[a.item],a.content[a.item]),this.size().open()):this.error():this.ajax(),this},ajax:function(){var b=this,c=new XMLHttpRequest,d=a.create.call(a.d,"div");c.onreadystatechange=function(){4===c.readyState&&(200===c.status?(d.innerHTML=c.responseText,a.content.push(3===d.childNodes.length?d.childNodes[2]:d),a.content[a.item].style.display="block",a.container[a.item].appendChild(a.content[a.item]),b.size().open()):b.error())},c.open("GET",a.settings[a.item].target+(a.settings[a.item].cache?"":"?_="+Date.now()),!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(null)},size:function(){{var b=a.content[a.item].offsetWidth;a.content[a.item].offsetHeight}return isNaN(a.settings[a.item].width)||null===a.settings[a.item].width||(b=parseInt(a.settings[a.item].width,0)),a.size.push(b),a.size[a.item]+60>=a.w.innerWidth?(a.container[a.item].style.width="auto",a.container[a.item].style.margin="5%"):a.container[a.item].style.width=a.size[a.item]+"px",a.content[a.item].style.width="auto",a.modal[a.item].appendChild(a.content[a.item]),a.content[a.item].offsetHeight>=a.w.innerHeight?(a.container[a.item].style.marginTop="5%",a.container[a.item].style.marginBottom="5%"):a.container[a.item].style.marginTop=a.w.innerHeight/2-a.content[a.item].offsetHeight/2+"px",this},open:function(){return a.settings[a.item].overlay?(c.overlay.perspective.indexOf(a.settings[a.item].overlayEffect)>-1||c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?a.overlay[a.item].classList.add("custombox-overlay-open"):a.overlay[a.item].style.opacity=a.settings[a.item].overlayOpacity,a.main.classList.add("custombox-container-open"),c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?a.wrapper[a.item].classList.add("custombox-modal-open"):a.overlay[a.item].addEventListener("transitionend",function(b){"transform"!==b.propertyName&&"-webkit-transform"!==b.propertyName&&"transform-origin"!==b.propertyName&&"opacity"!==b.propertyName&&!b.propertyName.match("^-webkit-transform-origin")||void 0!==a.close[a.item]||a.wrapper[a.item].classList.add("custombox-modal-open")},!1)):(a.wrapper[a.item].classList.add("custombox-modal-open"),a.main.classList.add("custombox-container-open")),this},binds:function(){var b=this;a.settings[a.item].escKey&&(a.d.onkeydown=function(c){c=c||a.w.event,27===c.keyCode&&b.close()}),a.settings[a.item].overlayClose&&a.wrapper[a.item].addEventListener("click",function(c){c.target===a.wrapper[a.item]&&void 0===a.close[a.item]&&b.close()},!1),a.w.addEventListener("onorientationchange"in a.w?"orientationchange":"resize",function(){b.responsive()},!1),a.wrapper[a.item].addEventListener("transitionend",function(b){"transform"!==b.propertyName&&"-webkit-transform"!==b.propertyName&&"opacity"!==b.propertyName||void 0!==a.open[a.item]||(a.open[a.item]=!0,a.settings[a.item]&&"function"==typeof a.settings[a.item].complete&&a.settings[a.item].complete.call())},!1)},close:function(){var b=function(){a.h.classList.remove("custombox-open-"+a.settings[a.item].overlayEffect),a.settings[a.item].overlay?(a.overlay[a.item].classList.add("custombox-overlay-close"),a.overlay[a.item].style.opacity&&(a.overlay[a.item].style.opacity=0),a.overlay[a.item].classList.remove("custombox-overlay-open"),a.main.classList.remove("custombox-container-open"),c.isIE?d():a.overlay[a.item].addEventListener("transitionend",function(b){"transform"!==b.propertyName&&"-webkit-transform"!==b.propertyName&&"opacity"!==b.propertyName||void 0!==a.close[a.item]||d()},!1)):void 0===a.close[a.item]&&(c.isIE?d():a.modal[a.item].addEventListener("transitionend",function(b){"transform"!==b.propertyName&&"-webkit-transform"!==b.propertyName&&"opacity"!==b.propertyName||void 0!==a.close[a.item]||d()}))},d=function(){a.item||(a.h.classList.remove("custombox-perspective","custombox-open"),"undefined"!=typeof a.scroll[a.item]&&a.w.scrollTo(0,a.scroll[a.item])),a.h.classList.remove("custombox-open-"+a.settings[a.item].overlayEffect),a.inline[a.item]&&(c.isIE?(a.content[a.item].removeAttribute("width"),a.content[a.item].removeAttribute("display")):(a.content[a.item].style.removeProperty("width"),a.content[a.item].style.removeProperty("display")),a.inline[a.item].parentNode.replaceChild(a.content[a.item],a.inline[a.item])),a.main.classList.remove("custombox-container-"+a.settings[a.item].overlayEffect),a.wrapper[a.item].parentNode.removeChild(a.wrapper[a.item]),a.settings[a.item].overlay&&(a.overlay[a.item].parentNode.removeChild(a.overlay[a.item]),a.overlay.pop()),"function"==typeof a.settings[a.item].close&&a.settings[a.item].close.call(),a.wrapper.pop(),a.close.pop(),a.inline.pop(),a.content.pop(),a.container.pop(),a.modal.pop(),a.size.pop(),a.settings.pop(),a.scroll.pop(),a.item--,a.close[a.item]=!0};a.item>-1&&(c.modal.position.indexOf(a.settings[a.item].effect)>-1&&a.settings[a.item].position.length>1&&(a.modal[a.item].classList.remove("custombox-modal-"+a.settings[a.item].effect+"-"+a.settings[a.item].position[0]),a.modal[a.item].classList.add("custombox-modal-"+a.settings[a.item].effect+"-"+a.settings[a.item].position[1].trim())),a.wrapper[a.item].classList.remove("custombox-modal-open"),c.isIE||c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?b():a.wrapper[a.item].addEventListener("transitionend",function(a){("transform"===a.propertyName||"-webkit-transform"===a.propertyName||"visibility"===a.propertyName||"opacity"===a.propertyName)&&b()},!1))},responsive:function(){for(var b=0,c=a.container.length;c>b;b++)a.size[b]+60>=a.w.innerWidth?(a.container[b].style.width="auto",a.container[b].style.marginLeft="5%",a.container[b].style.marginRight="5%"):(a.container[b].style.width=a.size[b]+"px",a.container[b].style.marginLeft="auto",a.container[b].style.marginRight="auto"),a.content[b].offsetHeight>=a.w.innerHeight?(a.container[b].style.marginTop="5%",a.container[b].style.marginBottom="5%"):a.container[b].style.marginTop=a.w.innerHeight/2-a.content[b].offsetHeight/2+"px"},error:function(){alert("Error!")}},e={script:function(a,b){var c=document.createElement("script");c.onload=c.onreadystatechange=function(){b()},c.text=a,document.getElementsByTagName("head")[0].appendChild(c)},zIndex:function(){window.getComputedStyle||(window.getComputedStyle=function(a){return this.el=a,this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;return"float"==b&&(b="styleFloat"),c.test(b)&&(b=b.replace(c,function(){return arguments[2].toUpperCase()})),a.currentStyle[b]?a.currentStyle[b]:null},this});var b=0;if(isNaN(a.settings[a.item].zIndex))for(var c=0,d=a.d.getElementsByTagName("*"),e=d.length;e>c;c+=1){var f=a.w.getComputedStyle(d[c]).getPropertyValue("z-index");f&&(f=+f,f>b&&(b=f))}else b=a.settings[a.item].zIndex;return b},extend:function(){for(var a=1,b=arguments.length;b>a;a++)for(var c in arguments[a])arguments[a].hasOwnProperty(c)&&(arguments[0][c]=arguments[a][c]);return arguments[0]}};return{open:function(b){a.options=b,d.init()},close:function(){d.close()}}}();